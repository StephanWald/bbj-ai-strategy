---
phase: 06-code-corrections
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/01-bbj-challenge/index.mdx
autonomous: true

must_haves:
  truths:
    - "Visual PRO/5 code blocks use PRINT (sysgui)'WINDOW'(...) mnemonic syntax, not WINDOW CREATE verbs"
    - "DWC code block uses addWindow(x,y,w,h,'title') with coordinate parameters"
    - "CTRL() references use channel-based ctrl(sysgui,controlId,index) syntax"
    - "Comparison table describes Visual PRO/5 as mnemonic-based, not verb-based"
    - "Prose descriptions of Visual PRO/5 match the corrected code syntax"
  artifacts:
    - path: "docs/01-bbj-challenge/index.mdx"
      provides: "Chapter 1 with corrected BBj code samples"
      contains: "print (sysgui)'window'"
  key_links:
    - from: "docs/01-bbj-challenge/index.mdx"
      to: "GuideToGuiProgrammingInBBj.pdf patterns"
      via: "code blocks matching PDF reference syntax"
      pattern: "print \\(sysgui\\)'window'"
---

<objective>
Fix all hallucinated BBj code samples and descriptions in Chapter 1 (The BBj Challenge).

Purpose: Chapter 1 is the foundation chapter that explains why generic LLMs fail on BBj -- but it ironically contains hallucinated code itself. The Visual PRO/5 code blocks use fabricated `WINDOW CREATE` / `BUTTON CREATE` verb syntax that does not exist in real BBj. The DWC code block has wrong method signatures. The CTRL() syntax is wrong. The comparison table repeats the errors. Fixing these is critical because this chapter is used to justify the entire AI strategy.

Output: A corrected `docs/01-bbj-challenge/index.mdx` where every BBj code sample and description matches the authoritative PDF reference patterns.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@docs/01-bbj-challenge/index.mdx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix all Visual PRO/5 code blocks and DWC code block</name>
  <files>docs/01-bbj-challenge/index.mdx</files>
  <action>
Replace all hallucinated Visual PRO/5 and DWC code blocks in Chapter 1 with correct syntax from the PDF reference. There are 6 specific locations to fix:

**A) Lines 64-74 -- Visual PRO/5 section header and code block:**

The prose at line 66 says "verb-based syntax: WINDOW CREATE, BUTTON CREATE, CTRL() for reading control values". Replace with a description of mnemonic-based syntax: Visual PRO/5 introduced GUI through a SYSGUI channel and mnemonic strings -- `PRINT (sysgui)'WINDOW'(...)`, `PRINT (sysgui)'BUTTON'(...)`, with `CTRL(sysgui,id,index)` for reading control values.

Replace the code block (lines 68-72) with correct Visual PRO/5 mnemonic syntax:
```bbj title="Visual PRO/5 -- Mnemonic-Based GUI"
sysgui = unt
open (sysgui)"X0"
print (sysgui)'window'(100,100,400,300,"Order Entry",$00010003$,$00000000$)
print (sysgui)'button'(201,10,250,100,30,"Save",$$)
status$ = ctrl(sysgui,201,0)
```

Update the prose paragraph after the code block (line 74) -- replace references to "WINDOW CREATE / BUTTON CREATE verb pattern" with "PRINT (sysgui)'WINDOW'(...) / 'BUTTON'(...) mnemonic pattern".

**B) Lines 120-123 -- Tabbed "Display a Greeting" Visual PRO/5 tab:**

Replace the hallucinated code:
```bbj title="Visual PRO/5 (1990s)"
sysgui = unt
open (sysgui)"X0"
print (sysgui)'window'(200,150,400,200,"Welcome",$00010003$,$00000000$)
print (sysgui)'button'(101,120,130,160,30,"Continue",$$)
```

**C) Lines 138-145 -- Tabbed "Display a Greeting" DWC tab:**

The DWC tab has wrong `addWindow`/`addStaticText`/`addButton` signatures (missing coordinate params). Replace with correct signatures:
```bbj title="DWC / Browser (2010s)"
sysgui! = BBjAPI().getSysGui()
window! = sysgui!.addWindow(200,150,400,200,"Welcome",$00010003$,$00000000$)
window!.addStaticText(100,20,30,360,25,"Welcome to Order Entry")
window!.addButton(101,120,130,160,30,"Continue",$$)
bui! = BBjAPI().getWebManager()
bui!.setTitle("Welcome to Order Entry")
```

**D) Lines 167-172 -- Tabbed "Read Customer Record" Visual PRO/5 tab:**

Replace the hallucinated CTRL syntax. The current code uses `CTRL(wnd, 3)` and `CTRL(wnd, 5, 0) = name$`. Replace with correct channel-based CTRL syntax:
```bbj title="Visual PRO/5 (1990s)"
custId$ = ctrl(sysgui,102,0)
open (1)"customers.dat"
read (1,key=custId$,err=*next)name$,balance
ctrl(sysgui,105,0)=name$
close (1)
```

Note: The ctrl() function uses the SYSGUI channel number as first arg, control ID as second, and property index as third. Reading a control value: `ctrl(sysgui,controlId,0)`. Setting a value: `ctrl(sysgui,controlId,0)=value$`.

**E) Line 215 -- Comparison table Legacy GUI row:**

Replace:
```
| **Legacy GUI** | Visual PRO/5 | `WINDOW CREATE`, `BUTTON CREATE`, `CTRL()` |
```
With:
```
| **Legacy GUI** | Visual PRO/5 | `PRINT (sysgui)'WINDOW'(...)`, `PRINT (sysgui)'BUTTON'(...)`, `CTRL(sysgui,id,index)` |
```

**F) Line 66 -- The prose description of Visual PRO/5:**

Current text says: "Visual PRO/5 introduced Windows-style GUI elements through a verb-based syntax: `WINDOW CREATE`, `BUTTON CREATE`, `CTRL()` for reading control values."

Replace with: "Visual PRO/5 introduced Windows-style GUI elements through a SYSGUI channel and mnemonic strings: programs open a system GUI device, then use `PRINT (sysgui)'WINDOW'(...)` to create windows, `PRINT (sysgui)'BUTTON'(...)` to create controls, and `CTRL(sysgui,id,index)` to read control values."

IMPORTANT: Keep all surrounding MDX structure intact -- the Tabs imports, TabItem wrappers, Mermaid diagrams, etc. Only replace the code blocks and the specific prose descriptions listed above.
  </action>
  <verify>
1. Search the file for "WINDOW CREATE" -- should appear ZERO times in code blocks and zero times in prose describing actual syntax. (It may still appear in the "Generic LLM Problem" section as an example of what LLMs get wrong -- that is fine if it is describing LLM hallucination behavior, but check the context.)
2. Search for "BUTTON CREATE" -- same criteria.
3. Search for "CTRL(wnd" -- should appear zero times (old wrong syntax).
4. Search for "print (sysgui)" or "PRINT (sysgui)" -- should appear in Visual PRO/5 code blocks.
5. Search for "ctrl(sysgui" -- should appear in the corrected code.
6. Verify the DWC addWindow call has coordinate parameters: `addWindow(200,150,400,200,"Welcome"`
7. Run `npm run build` from project root to confirm the MDX still compiles.
  </verify>
  <done>
All 6 locations (A-F) are corrected:
- Three Visual PRO/5 code blocks use `print (sysgui)'window'(...)` mnemonic syntax
- DWC code block uses `addWindow(x,y,w,h,"title")` with coordinates
- CTRL() uses `ctrl(sysgui,controlId,index)` channel-based syntax
- Comparison table row describes mnemonic-based approach
- Prose descriptions match corrected code
- Site builds successfully with `npm run build`
  </done>
</task>

</tasks>

<verification>
1. `grep -n "WINDOW CREATE" docs/01-bbj-challenge/index.mdx` returns zero matches (or matches only within the "Generic LLM Problem" hallucination example section)
2. `grep -n "BUTTON CREATE" docs/01-bbj-challenge/index.mdx` returns zero matches (or matches only within hallucination example)
3. `grep -n "ctrl(sysgui" docs/01-bbj-challenge/index.mdx` returns matches in corrected code blocks
4. `grep -n "print (sysgui)" docs/01-bbj-challenge/index.mdx` returns matches in Visual PRO/5 code blocks
5. `npm run build` succeeds without errors
</verification>

<success_criteria>
- Zero hallucinated Visual PRO/5 verb syntax remains in Chapter 1 code blocks or descriptions
- DWC code uses correct addWindow signature with coordinate parameters
- All CTRL references use channel-based syntax
- Comparison table is accurate
- Site builds cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/06-code-corrections/06-01-SUMMARY.md`
</output>
