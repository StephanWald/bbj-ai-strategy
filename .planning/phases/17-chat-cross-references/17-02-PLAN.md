---
phase: 17-chat-cross-references
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/03-fine-tuning/index.md
  - docs/06-rag-database/index.md
autonomous: true

must_haves:
  truths:
    - "Chapter 3 has an MCP Integration subsection explaining the model is consumed via generate_bbj_code tool, cross-referencing Chapter 2"
    - "Chapter 6 has an MCP Integration subsection explaining retrieval is exposed via search_bbj_knowledge tool, cross-referencing Chapter 2"
    - "Chapter 6 status block reflects v1.2 shipped pipeline and mentions search_bbj_knowledge as the planned retrieval interface"
    - "Neither chapter duplicates MCP tool schemas from Chapter 2"
    - "Chapter 3 status block date is NOT changed (no new status to report)"
  artifacts:
    - path: "docs/03-fine-tuning/index.md"
      provides: "MCP Integration subsection before Current Status"
      contains: "### MCP Integration"
    - path: "docs/06-rag-database/index.md"
      provides: "MCP Integration subsection before Current Status, updated status block"
      contains: "### MCP Integration"
  key_links:
    - from: "docs/03-fine-tuning/index.md"
      to: "docs/02-strategic-architecture/index.md"
      via: "Inline cross-reference link to generate_bbj_code"
      pattern: "/docs/strategic-architecture#generate_bbj_code"
    - from: "docs/06-rag-database/index.md"
      to: "docs/02-strategic-architecture/index.md"
      via: "Inline cross-reference link to search_bbj_knowledge"
      pattern: "/docs/strategic-architecture#search_bbj_knowledge"
---

<objective>
Add MCP Integration subsections to Chapters 3 and 6, and update Chapter 6's status block to reflect the v1.2 shipped pipeline.

Purpose: Readers following Chapter 3 (Fine-Tuning) or Chapter 6 (RAG Database) encounter the MCP connection -- learning how the model and retrieval pipeline connect to the broader MCP ecosystem defined in Chapter 2. Chapter 6's status block reflects the actual shipped state.

Output: Updated docs/03-fine-tuning/index.md (XREF-01) and docs/06-rag-database/index.md (XREF-02).
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-chat-cross-references/17-RESEARCH.md
@docs/03-fine-tuning/index.md
@docs/06-rag-database/index.md
@docs/02-strategic-architecture/index.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add MCP Integration subsection to Chapter 3 (Fine-Tuning)</name>
  <files>docs/03-fine-tuning/index.md</files>
  <action>
Add a `### MCP Integration` subsection to Chapter 3. Place it AFTER the "Hosting via Ollama" section (which ends with the deployment architecture diagram around line 399) and BEFORE the "Current Status" block (line 401, the `## Current Status` heading).

**Content (2-3 paragraphs):**

Use the RESEARCH.md Example 2 as the template. The subsection explains:

1. The fine-tuned model is consumed through the BBj MCP server's `generate_bbj_code` tool, defined in [Chapter 2](/docs/strategic-architecture#generate_bbj_code). The tool accepts a natural language prompt, target generation, and optional code context. It assembles RAG-retrieved documentation into an enriched prompt and forwards it to the Ollama-hosted model.

2. Any MCP-compatible client (Claude, Cursor, VS Code, custom applications) can generate BBj code using the fine-tuned model without building custom Ollama integration. When the model improves through continued fine-tuning, every client benefits immediately.

3. Closing sentence directing to Ch2 for full MCP server architecture.

**Cross-reference format:** Inline links, matching Ch3's established style. Examples from existing text:
- `[Chapter 1](/docs/bbj-challenge)` (line 13)
- `[IDE extension](/docs/ide-integration)` (line 415)

Use the same pattern: `[Chapter 2](/docs/strategic-architecture#generate_bbj_code)` for the tool link and `[Chapter 2: Strategic Architecture](/docs/strategic-architecture#the-mcp-server-concrete-integration-layer)` for the full architecture link.

**DO NOT:**
- Change the Ch3 status block date or content (no new status to report -- per RESEARCH.md Open Question 2)
- Duplicate the `generate_bbj_code` JSON schema from Ch2
- Explain MCP protocol internals
- Modify any existing content in Ch3 (only ADD the new subsection)

**DO:**
- Use `### MCP Integration` as an H3 heading (matches Ch3's existing subsection level)
- Keep tool names in backticks: `generate_bbj_code`
- Reference the QLoRA pipeline "described above" to connect to the chapter's narrative
  </action>
  <verify>
Read the modified file. Confirm:
1. `### MCP Integration` heading exists between the deployment architecture section and `## Current Status`
2. `generate_bbj_code` appears in the subsection with backtick formatting
3. Cross-reference link to `/docs/strategic-architecture#generate_bbj_code` exists
4. No JSON schema block is present in the new subsection
5. The `## Current Status` block is UNCHANGED (still says "January 2026")
6. The closing paragraph (line 415) is UNCHANGED
  </verify>
  <done>Chapter 3 has a 2-3 paragraph MCP Integration subsection explaining the model is consumed via `generate_bbj_code` tool, with cross-reference to Chapter 2. No schema duplication. Status block unchanged. XREF-01 satisfied.</done>
</task>

<task type="auto">
  <name>Task 2: Add MCP Integration subsection and update status block in Chapter 6 (RAG Database)</name>
  <files>docs/06-rag-database/index.md</files>
  <action>
Two changes to Chapter 6:

**Change 1: Add `### MCP Integration` subsection**

Place it AFTER the "Generation-Aware Retrieval" section (which ends around line 497 with the retrieval example) and BEFORE the `## Current Status` heading (line 498).

Use the RESEARCH.md Example 3 as the template. The subsection explains:

1. The retrieval pipeline is exposed through the BBj MCP server's `search_bbj_knowledge` tool, defined in [Chapter 2](/docs/strategic-architecture#search_bbj_knowledge). The tool accepts a natural language query and optional generation filter, performs the hybrid search pipeline described in this chapter, and returns ranked results with source citations.

2. This is the primary interface for the documentation chat and any MCP-compatible client. Whether a developer asks through chat, Claude, or Cursor, the same retrieval pipeline returns the same generation-aware results.

3. Closing sentence referencing Ch2 for the full MCP architecture and the other two tools (`generate_bbj_code` and `validate_bbj_syntax`).

**Cross-reference format:** Inline links matching Ch6's established style. Use:
- `[Chapter 2](/docs/strategic-architecture#search_bbj_knowledge)` for the tool link
- `[documentation chat](/docs/documentation-chat)` for the Ch5 link
- `[Chapter 2: Strategic Architecture](/docs/strategic-architecture#the-mcp-server-concrete-integration-layer)` for the full architecture link

**Change 2: Update the `:::note[Where Things Stand]` status block**

Replace the existing status block (lines 500-504) with an updated version. Use RESEARCH.md Example 4 as the template:

```markdown
:::note[Where Things Stand -- February 2026]
- **Shipped:** RAG ingestion pipeline (v1.2) -- 6 source parsers, embedding pipeline, generation-aware tagging, hybrid search. Built and tested, awaiting deployment against production corpus.
- **Defined:** Source corpus identified -- MadCap Flare documentation (primary), BBj source code, API references, and knowledge base articles. Generation metadata schema established (shared with [training data](/docs/fine-tuning)).
- **Planned:** Retrieval exposed via MCP `search_bbj_knowledge` tool ([Chapter 2](/docs/strategic-architecture#search_bbj_knowledge)) for consumption by documentation chat and any MCP client.
- **Planned next:** Deploy pipeline against production corpus. Index full BBj documentation, tune retrieval quality, validate with representative queries.
:::
```

Key changes from existing status:
- Date: "January 2026" -> "February 2026"
- First bullet: "Defined: Source corpus identified" -> now under second bullet; new first bullet is "Shipped: RAG ingestion pipeline (v1.2)"
- "Not built: Ingestion pipeline..." -> REMOVED (pipeline IS built now)
- New "Planned" bullet with MCP `search_bbj_knowledge` reference
- "Planned next" updated to reflect deployment against production corpus

Also update the paragraph AFTER the status block (line 506). It currently says "The RAG database is designed but not yet implemented." This is now stale -- the pipeline IS implemented (v1.2). Update to reflect that the pipeline is built and the next step is deployment against the production corpus. Keep the reference to the implementation roadmap.

**DO NOT:**
- Modify any prose sections of Ch6 (per CONTEXT.md: "Status block only -- prose descriptions remain as-is")
- Duplicate the `search_bbj_knowledge` JSON schema from Ch2
- Change Ch6's existing decision callouts
- Modify the "What Comes Next" section
  </action>
  <verify>
Read the modified file. Confirm:
1. `### MCP Integration` heading exists between Generation-Aware Retrieval and Current Status
2. `search_bbj_knowledge` appears in the MCP Integration subsection with backtick formatting
3. Cross-reference link to `/docs/strategic-architecture#search_bbj_knowledge` exists
4. Status block says "February 2026"
5. Status block mentions "Shipped: RAG ingestion pipeline (v1.2)"
6. Status block mentions `search_bbj_knowledge` in the Planned bullet
7. "Not built: Ingestion pipeline" is GONE
8. Post-status paragraph no longer says "designed but not yet implemented"
9. No JSON schema block present in the MCP Integration subsection
10. Existing prose sections and decision callouts are UNCHANGED
11. `cd /Users/beff/_workspace/bbj-ai-strategy && npx docusaurus build 2>&1 | tail -5` exits clean
  </verify>
  <done>Chapter 6 has a 2-3 paragraph MCP Integration subsection explaining retrieval is exposed via `search_bbj_knowledge` tool, with cross-reference to Chapter 2. Status block updated to reflect v1.2 shipped pipeline and MCP planned interface. No schema duplication. XREF-02 satisfied.</done>
</task>

</tasks>

<verification>
After both tasks complete, verify:
1. `grep "### MCP Integration" docs/03-fine-tuning/index.md` finds the new subsection
2. `grep "### MCP Integration" docs/06-rag-database/index.md` finds the new subsection
3. `grep "generate_bbj_code" docs/03-fine-tuning/index.md` finds references in the MCP Integration subsection
4. `grep "search_bbj_knowledge" docs/06-rag-database/index.md` finds references in both MCP Integration subsection and status block
5. `grep "February 2026" docs/06-rag-database/index.md` finds the updated status block date
6. `grep "January 2026" docs/03-fine-tuning/index.md` confirms Ch3 status date is UNCHANGED
7. `grep -c "inputSchema" docs/03-fine-tuning/index.md` returns 0 (no schema duplication)
8. `grep -c "inputSchema" docs/06-rag-database/index.md` returns 0 (no schema duplication)
9. `grep "Not built.*Ingestion pipeline" docs/06-rag-database/index.md` returns NOTHING (stale status removed)
10. Docusaurus builds clean: `npx docusaurus build` exits 0
</verification>

<success_criteria>
- Chapter 3 has MCP Integration subsection with `generate_bbj_code` reference and Ch2 cross-link
- Chapter 6 has MCP Integration subsection with `search_bbj_knowledge` reference and Ch2 cross-link
- Chapter 6 status block reflects v1.2 shipped pipeline with February 2026 date
- Chapter 3 status block is unchanged (January 2026)
- No schema duplication from Chapter 2 in either chapter
- Both subsections are 2-3 paragraphs using inline cross-reference links
- Site builds clean
</success_criteria>

<output>
After completion, create `.planning/phases/17-chat-cross-references/17-02-SUMMARY.md`
</output>
