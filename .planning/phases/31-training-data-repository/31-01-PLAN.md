---
phase: 31-training-data-repository
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - training-data/README.md
  - training-data/FORMAT.md
  - training-data/CONTRIBUTING.md
  - training-data/schema/example.schema.json
  - training-data/scripts/validate.py
  - training-data/gui/hello-window.md
  - training-data/database/keyed-file-read.md
autonomous: true

must_haves:
  truths:
    - "Repository structure exists with topic directories"
    - "Front matter schema defines required fields (title, type, generation)"
    - "Validation script catches invalid examples"
    - "Seed examples render correctly in GitHub"
    - "Contributors know how to add new examples"
  artifacts:
    - path: "training-data/README.md"
      provides: "Overview and quick start"
      min_lines: 30
    - path: "training-data/FORMAT.md"
      provides: "Detailed format specification"
      min_lines: 50
    - path: "training-data/CONTRIBUTING.md"
      provides: "Contributor workflow guide"
      min_lines: 30
    - path: "training-data/schema/example.schema.json"
      provides: "JSON Schema for front matter validation"
      contains: "\"required\""
    - path: "training-data/scripts/validate.py"
      provides: "Validation script"
      contains: "jsonschema.validate"
    - path: "training-data/gui/hello-window.md"
      provides: "GUI seed example"
      contains: "BBjAPI().getSysGui()"
    - path: "training-data/database/keyed-file-read.md"
      provides: "Database seed example"
      contains: "READ (1, KEY="
  key_links:
    - from: "training-data/scripts/validate.py"
      to: "training-data/schema/example.schema.json"
      via: "loads schema file"
      pattern: "example\\.schema\\.json"
    - from: "training-data/gui/hello-window.md"
      to: "training-data/schema/example.schema.json"
      via: "front matter conforms to schema"
      pattern: "type: completion"
---

<objective>
Create training data repository infrastructure with format specification, validation tooling, and seed examples.

Purpose: Establish a systematic way to collect and validate curated BBj code examples that can later be converted to JSONL for fine-tuning. This provides the foundation for building a high-quality training corpus.

Output: `training-data/` directory with documentation, JSON Schema, validation script, and 2 seed examples demonstrating the format.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/31-training-data-repository/31-CONTEXT.md
@.planning/phases/31-training-data-repository/31-RESEARCH.md

# Strategy document for TrainingExample schema reference
@bbj-llm-strategy.md (lines 1095-1121 for training data schema)

# Existing pattern for frontmatter parsing
@rag-ingestion/src/bbj_rag/parsers/mdx.py (for frontmatter usage pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create directory structure and JSON Schema</name>
  <files>
    training-data/schema/example.schema.json
    training-data/gui/.gitkeep
    training-data/database/.gitkeep
    training-data/strings/.gitkeep
    training-data/file-io/.gitkeep
    training-data/control-flow/.gitkeep
    training-data/oop/.gitkeep
    training-data/dwc/.gitkeep
    training-data/scripts/.gitkeep
  </files>
  <action>
    Create the `training-data/` directory at project root with the following structure:
    - `schema/example.schema.json` - JSON Schema for front matter validation
    - Topic directories: `gui/`, `database/`, `strings/`, `file-io/`, `control-flow/`, `oop/`, `dwc/`
    - `scripts/` directory for tooling

    **JSON Schema requirements** (from bbj-llm-strategy.md TrainingExample interface):
    - Required fields: `title` (string, minLength 1), `type` (enum), `generation` (string or array)
    - `type` enum: "completion", "comprehension", "migration", "explanation"
    - `generation`: Either string ("all", "character", "vpro5", "bbj-gui", "dwc") OR array of those values
    - Optional fields: `difficulty` (enum: basic/intermediate/advanced), `tags` (array of strings), `description` (string), `requires_version` (string), `from_generation` (string, for migration type), `to_generation` (string or array, for migration type)

    Use `oneOf` pattern for generation to allow both string and array.
    Use `$schema` draft-07 for compatibility with jsonschema library.
  </action>
  <verify>
    - `ls -la training-data/` shows expected directory structure
    - `cat training-data/schema/example.schema.json | python -m json.tool` validates JSON syntax
    - Schema contains "required": ["title", "type", "generation"]
  </verify>
  <done>Directory structure exists with all topic directories and a valid JSON Schema defining the front matter format per the TrainingExample interface.</done>
</task>

<task type="auto">
  <name>Task 2: Create documentation files</name>
  <files>
    training-data/README.md
    training-data/FORMAT.md
    training-data/CONTRIBUTING.md
  </files>
  <action>
    Create three documentation files:

    **README.md** - Overview and quick start:
    - What: Curated BBj code examples for fine-tuning
    - Why: LLMs have near-zero BBj training data; we need high-quality examples
    - How: Markdown files with YAML front matter, organized by topic
    - Quick start: How to run validation, where to find format spec
    - Link to FORMAT.md for details, CONTRIBUTING.md for workflow

    **FORMAT.md** - Detailed format specification:
    - Front matter schema (reference the JSON Schema)
    - Required fields with examples and allowed values
    - Optional fields and when to use them
    - Content sections: ## Code (fenced ```bbj block), ## Expected Behavior or ## Expected Output, ## Explanation
    - "Code first, explanation after" structure per CONTEXT.md decision
    - Multi-file programs: Use multiple fenced blocks with `<!-- filename: foo.bbj -->` comment
    - BBj code conventions: Always use ```bbj fence, include REM comment at top describing purpose

    **CONTRIBUTING.md** - How to add new examples:
    - Step 1: Choose appropriate topic directory
    - Step 2: Create file with descriptive kebab-case name (e.g., `button-callback.md`)
    - Step 3: Add required front matter fields
    - Step 4: Add Code, Expected Behavior/Output, Explanation sections
    - Step 5: Run validation: `python training-data/scripts/validate.py`
    - Step 6: Submit PR
    - Common mistakes to avoid (missing generation, wrong type enum, etc.)
  </action>
  <verify>
    - All three files exist and have substantial content (30+ lines each)
    - README.md contains links to FORMAT.md and CONTRIBUTING.md
    - FORMAT.md references the JSON Schema
    - CONTRIBUTING.md includes validation command
  </verify>
  <done>Documentation provides complete guidance for understanding, creating, and validating training examples.</done>
</task>

<task type="auto">
  <name>Task 3: Create validation script and seed examples</name>
  <files>
    training-data/scripts/validate.py
    training-data/gui/hello-window.md
    training-data/database/keyed-file-read.md
  </files>
  <action>
    **Validation script** (`training-data/scripts/validate.py`):
    - Executable Python script with shebang `#!/usr/bin/env python3`
    - Discovers all .md files in training-data/ recursively (skip README.md, FORMAT.md, CONTRIBUTING.md)
    - Parses each file with `frontmatter.load()`
    - Validates metadata against `schema/example.schema.json` using `jsonschema.validate()`
    - Checks for non-empty content (has at least one code block)
    - Prints OK for valid files, ERROR with message for invalid
    - Returns exit code 0 if all pass, 1 if any fail
    - Can be run from project root: `python training-data/scripts/validate.py`
    - Uses pathlib for cross-platform paths
    - Resolve schema path relative to script location

    **Seed example 1** (`training-data/gui/hello-window.md`):
    - Per RESEARCH.md "Complete Seed Example: GUI Window"
    - Front matter: title, type: completion, generation: ["bbj-gui", "dwc"], difficulty: basic, tags, description
    - Code: BBjAPI().getSysGui() window creation with callback and process_events
    - Expected Behavior: Window appears, stays open until closed
    - Explanation: Step-by-step breakdown of each line

    **Seed example 2** (`training-data/database/keyed-file-read.md`):
    - Per RESEARCH.md "Complete Seed Example: Keyed File Read"
    - Front matter: title, type: comprehension, generation: all, difficulty: basic, tags, description
    - Code: OPEN, READ with KEY=, error handling, CLOSE
    - Expected Output: Show both success and not-found cases
    - Explanation: Channel numbers, KEY clause, ERR clause, field list

    Both examples should pass validation.
  </action>
  <verify>
    - Run `python training-data/scripts/validate.py` - should print OK for both examples and exit 0
    - Run with verbose output showing 2 files validated
    - `cat training-data/gui/hello-window.md` shows complete example with front matter
    - `cat training-data/database/keyed-file-read.md` shows complete example
  </verify>
  <done>Validation script works and both seed examples pass validation, demonstrating the complete workflow.</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Structure verification:**
   ```bash
   find training-data -type f | sort
   ```
   Should show: README.md, FORMAT.md, CONTRIBUTING.md, schema/example.schema.json, scripts/validate.py, gui/hello-window.md, database/keyed-file-read.md

2. **Validation verification:**
   ```bash
   python training-data/scripts/validate.py
   ```
   Should output success for both seed examples with exit code 0

3. **Schema verification:**
   Test with deliberately invalid example (manually create temp file missing required field, run validator, expect error)

4. **Documentation rendering:**
   View README.md in GitHub or with `glow training-data/README.md` if available
</verification>

<success_criteria>
- [ ] `training-data/` directory exists at project root with topic subdirectories
- [ ] JSON Schema defines title, type, generation as required fields with correct types
- [ ] README.md explains purpose and provides quick start
- [ ] FORMAT.md documents all front matter fields and content structure
- [ ] CONTRIBUTING.md provides step-by-step workflow for adding examples
- [ ] Validation script discovers and validates markdown files against schema
- [ ] Two seed examples exist (gui/hello-window.md, database/keyed-file-read.md)
- [ ] Both seed examples pass validation
- [ ] Requirements TRAIN-01, TRAIN-02, TRAIN-03, TRAIN-04 all satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/31-training-data-repository/31-01-SUMMARY.md`
</output>
